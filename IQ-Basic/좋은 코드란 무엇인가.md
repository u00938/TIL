
## 좋은 코드란

읽기 쉬운 코드, 중복이 없는 코드, 테스트가 용이한 코드

읽기 쉬운 코드를 위해선 단순하게 익숙한 언어를 쓰는 것을 생각할 수 있는데, 주석을 사용하여 코드를 이해하기 쉽게 한다. 그러나 주석은 관리가 어려우며 기본적으로 메타데이터이기 때문에 함수의 실제 동작이 일치한다고 보장할 수 없고 함수가 수정될 때 주석도 수정되지 않으면 잘못된 주석으로 오히려 혼란을 야기할 수 있다.
또한 ‘읽기 쉽다’는 것은 각자 다른 배경지식을 가진 개개인에게 다르게 받아들여지기 때문에 기준이 모호하다. 

중복되는 코드는 불필요하게 느껴지고 한곳에서만 수정되었을 시 다른 곳에서 버그가 일어날 수도 있다. 때문에 동일한 로직을 수행하는 코드는 별도의 함수로 빼두고 재사용하는 것이 타당하게 느껴진다.
하지만 이렇게 공통으로 사용되던 코드가 조금 다른 식으로 수정이 필요해질 때, 이전에는 동일했지만 이 살짝 달라지는 기능 때문에 다시 분리하는 등 결국 비용이 들어가게 된다.

좋은 코드란, 좋지 않은 코드가 없는 코드라고 간단히 정의해 볼 수 있다. 좋은 코드라는 모호한 기준을 노력하는 대신, 좋지 않은 코드를 줄여보는 것이 직관적으로 다가온다. 

단순히 중복된 코드 덩어리를 추출하는 것은 오히려 함수 간 의존 관계를 파악하기 위해 비용이 들어가기 때문에 잘못된 코드라고 볼 수 있다. 중복되는 코드를 그대로 추출했을 때 이 코드에 새로운 변경이 추가될 경우 어떤 인자가 추가된다든지, 내부에서 어떤 분기가 또 새로 추가되어 로직을 재구성해야 될 것이다.
함수를 분리할 때는 그 함수의 역할을 명확히 하고 하나의 역할만 하도록 정의한다. 즉, 의존성을 드러내기 위한 추출이 되어야 한다. 한 파일에 여러 로직이 얽혀있을 때 각 코드 조각 중 서로 의존 관계에 있는 것들을 추출하여 단순히 밖으로 끌어내는 의미의 추출이 아닌, 하나의 역할을 갖게 하는 의미있는 추출, 추상화가 이루어져야 한다. 의존성을 기반으로 분리된 여러 함수들은 각자의 역할을 수행하고 있기 때문에 새로운 변경이 추가되어 수정이 필요할 경우에도 필요한 부분의 함수만 수정하면 되며 각자의 영역을 침범할 필요가 없다.

좋지 않은 코드가 생산되는 것을 완전히 차단할 수 없다면 제대로 관리될 수 있도록 격리해야 한다. 아무리 깔끔한 코드를 작성해도 비즈니스 요구사항을 맞추다 보면 코드가 복잡해지는데, 이런 코드는 제 3자 입장에선 읽기도 어렵고 섣불리 삭제하기도 어렵다. 복잡한 요구 사항을 담고 있는 코드는 변경에 유연하지 못하기 때문에 별도로 분리해둬야 한다.

읽기 쉬운 코드의 기준은 모호하지만 최소한의 가독성을 보장하는 방법은 일관성 있는 코드를 작성하는 것이다. 일관성은 합의된 규칙을 기반으로 만들어지기 때문에 개개인에게 동일하게 받아들여진다. 코드에 일관성이 지켜진다면 예측이 가능하고, 예측이 가능하다는 것은 어느 곳에 어떤 코드가 위치하는지 예상할 수 있다는 것이다. 

예를 들면 함수의 네이밍에도 규칙이 있으면 일관성을 지킬 수 있다. 단순한 이벤트 핸들러를 정의할 때도 컨벤션을 지켜서 정의한다면 해당하는 함수를 보고 이벤트 핸들러라는 예상이 가능해진다.
또한 일관된 디렉토리 구조는 전체적인 구조를 파악하는 데 큰 도움이 되고 컴포넌트 간의 관계를 파악하는데에도 도움을 준다. 탑 레벨의 디렉토리 구성에 따라 어느 곳에 어떤 모듈 또는 컴포넌트들이 위치할지 예측이 된다면 코드를 빠르게 이해할 수 있다.

확장성이 어려운 코드는 내부에서 많은 변경이 발생하며 이것은 코드를 읽기 어렵게 만들고 자연스럽게 생산성을 떨어뜨린다. 확장이 닫혀있다는 뜻은 새로운 값을 전달하기 어려운 구조라는 뜻이다. 반대로 확장에 너무 많이 열려있으면 내부 API를 수정하기 어려워지는 문제도 발생할 수 있다. 확장성이 높으면 많은 use-case에 대응할 수는 있지만 내부적으로 큰 변화가 있을 때, breaking change가 생길 가능성이 높기 때문에 적정선을 찾는 것이 중요하다.


## 결론

좋은 코드를 작성하기 위해 코드 간의 의존성을 고민하고, 합의된 규칙으로 일관성 있게 작성하고, 적절하게 확장 가능하도록 설계한다. 좋지 않은 코드는 주석과 함께 격리한다.
